<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Timesheet Report</title>
    <style>
        .main-container {
            padding: 0px 10px;
        }

        .main-container .header {
            text-align: center;
        }

        .timesheet-report {
            width: 100%;
            border-collapse: collapse;
            margin-top: 0px;
            scrollbar-width: thin;
            border: 1px solid #EAEAEA;
            background-color: #FFFFFF;
        }

        .timesheet-report th,
        .timesheet-report td {
            padding: 15px 8px;
            font-size: 16px;
            border-bottom: 1px solid #EAEAEA;
        }

        .timesheet-report th {
            background-color: #343A40;
            color: #FFFFFF;
            text-align: center;
        }

        .clock-entry {
            padding: 5px 10px;
            background-color: #f7f7f7;
            margin-bottom: 5px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .main-container p span {
            font-weight: bold;
            font-size: 22px;
        }

        .main-container li {
            padding-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <h1 class="header">Timesheet Report</h1>
        <p><span>Name:</span> <%= data.userName %></p>
        <p><span>Email:</span> <%= data.userEmail %></p>
        <p><span>Contact Number:</span> <%= data.userContactNumber %></p>
        <p><span>Job Title:</span> <%= data.userJobTitle %></p>
        <p><span>Role:</span> <%= data.userRole %></p>
        <p><span>Time-Duration:</span> <%= data.startDate %> to <%= data.endDate %></p>
        <% weeklySummary.forEach((week, index) => { %>
            <li>Week <%= index + 1 %> (<%= week.weekRange %>) Total Hours: <%= week.totalHours %> || Overtime: <%= week.overTime %></li>
        <% }); %>
        <table class="timesheet-report">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Clock Timing</th>
                    <th>Total Hours</th>
                    <th>Overtime</th>
                    <th>Status</th>
                    <th>Leave Type</th>
                    <!-- <th>Holiday Occasion</th> -->
                </tr>
            </thead>
            <tbody>
                <% reportData.forEach(entry => { 
                    %>
                        <tr>
                            <td class="clock-entry"><%= moment(entry.date).format('DD-MM-YYYY') %></td>
                            <td>
                                <% 
                                    if (entry.clockinTime && entry.clockoutTime) { 
                                        let clockinTimes = entry.clockinTime.split('||').map(time => time.trim()); 
                                        let clockoutTimes = entry.clockoutTime.split('||').map(time => time.trim());
                                        let hasValidData = clockinTimes.some(time => time && time !== "-") || clockoutTimes.some(time => time && time !== "-");
                                        if (hasValidData) {
                                            for (let i = 0; i < clockinTimes.length; i++) { 
                                                let clockin = clockinTimes[i] && clockinTimes[i] !== "-" ? clockinTimes[i] : "-";
                                                let clockout = clockoutTimes[i] && clockoutTimes[i] !== "-" ? clockoutTimes[i] : "-";
                                                %>
                                                    <p class="clock-entry"><%= clockin %> || <%= clockout %></p>
                                                <% 
                                            }
                                        } else { 
                                            %>
                                                <p class="clock-entry">-</p>
                                            <% 
                                        } 
                                    } else { 
                                        %>
                                            <p class="clock-entry">-</p>
                                        <% 
                                    } 
                                %>
                            </td>
                            <td class="clock-entry"><%= entry.totalHours ? entry.totalHours : '-' %></td>
                            <td class="clock-entry"><%= entry.overTime ? entry.overTime : '-' %></td>
                            <td class="clock-entry"><%= entry.status %></td>
                            <td class="leave-entry"><%= entry.leaveType ? entry.leaveType : '-' %></td>
                            <!-- <td class="clock-entry"><%= entry.holidayOccasion ? entry.holidayOccasion : '-' %></td> -->
                        </tr>
                    <% 
                }); %>
            </tbody>
        </table>
    </div>
</body>
</html>